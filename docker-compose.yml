services:
  caddy:
    image: docker.io/caddy
    restart: unless-stopped
    ports:
      - "8000:80"
    volumes:
      - "./docker/caddy:/etc/caddy"
      - "./public:/srv/public:ro"
      - "./src:/srv/src:ro"
    # environment:
    #   - DOMAIN=example.com

  php:
    # image: docker.io/php:8.5-fpm-alpine
    build:
      context: .
      dockerfile: php.Dockerfile
    restart: unless-stopped
    volumes:
      - "./src:/srv/src:ro"

  db:
    image: docker.io/mariadb:12.1
    restart: unless-stopped
    env_file:
      - ./db.env
    volumes:
      - db-data:/var/lib/mysql

  phpmyadmin:
    image: docker.io/phpmyadmin:5.2
    restart: unless-stopped
    ports:
      - "8080:80"

volumes:
  db-data: